{"ast":null,"code":"var _jsxFileName = \"C:\\\\water\\\\chemical-dispersion-app\\\\frontend\\\\src\\\\components\\\\Map\\\\DispersionMap.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup, Circle } from 'react-leaflet';\nimport { apiService } from '../../services/api';\nimport 'leaflet/dist/leaflet.css';\nimport L from 'leaflet';\nimport './DispersionMap.css';\n\n// Fix for default markers in react-leaflet\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: require('leaflet/dist/images/marker-icon-2x.png'),\n  iconUrl: require('leaflet/dist/images/marker-icon.png'),\n  shadowUrl: require('leaflet/dist/images/marker-shadow.png')\n});\nfunction DispersionMap({\n  spills = [],\n  selectedSpill,\n  onSpillSelect,\n  calculateDispersion\n}) {\n  _s();\n  var _dispersionData$dispe, _dispersionData$dispe2;\n  const [dispersionData, setDispersionData] = useState(null);\n  const [isCalculating, setIsCalculating] = useState(false);\n  const [error, setError] = useState(null);\n  const [mapCenter] = useState([29.7604, -95.3698]); // Houston, TX\n  const calculationRef = useRef(null);\n  const hasCalculatedRef = useRef(new Set()); // Track calculated spills\n  const lastCalculationRef = useRef(null);\n  useEffect(() => {\n    // Only calculate if we have a selected spill and haven't calculated it recently\n    if (selectedSpill !== null && selectedSpill !== void 0 && selectedSpill.id && !hasCalculatedRef.current.has(selectedSpill.id) && !isCalculating && lastCalculationRef.current !== selectedSpill.id) {\n      handleCalculateDispersion(selectedSpill.id);\n    }\n  }, [selectedSpill === null || selectedSpill === void 0 ? void 0 : selectedSpill.id]); // Only depend on spill ID\n\n  const handleCalculateDispersion = async spillId => {\n    // Prevent multiple calculations for the same spill\n    if (isCalculating || hasCalculatedRef.current.has(spillId) || lastCalculationRef.current === spillId) {\n      console.log(`[SKIP] Already calculating or calculated for spill ${spillId}`);\n      return;\n    }\n    setIsCalculating(true);\n    setError(null);\n    lastCalculationRef.current = spillId;\n    try {\n      console.log(`[CALCULATING] Starting dispersion for spill ${spillId}`);\n      const result = await calculateDispersion(spillId, 24);\n      setDispersionData(result);\n      hasCalculatedRef.current.add(spillId); // Mark as calculated\n\n      console.log(`[SUCCESS] Dispersion calculation completed for ${spillId}`);\n    } catch (error) {\n      console.error('Dispersion calculation failed:', error);\n      setError('Failed to calculate dispersion. Please try again.');\n      hasCalculatedRef.current.delete(spillId); // Allow retry\n    } finally {\n      setIsCalculating(false);\n    }\n  };\n  const handleManualCalculation = () => {\n    if (selectedSpill !== null && selectedSpill !== void 0 && selectedSpill.id) {\n      // Force recalculation by removing from calculated set\n      hasCalculatedRef.current.delete(selectedSpill.id);\n      lastCalculationRef.current = null;\n      handleCalculateDispersion(selectedSpill.id);\n    }\n  };\n  const getMarkerColor = spill => {\n    if (spill.status === 'ACTIVE') return 'red';\n    if (spill.status === 'CONTAINED') return 'orange';\n    if (spill.status === 'CLEANED_UP') return 'green';\n    return 'gray';\n  };\n  const createCustomIcon = color => {\n    return L.divIcon({\n      className: 'custom-div-icon',\n      html: `<div style=\"background-color: ${color}; width: 20px; height: 20px; border-radius: 50%; border: 2px solid white;\"></div>`,\n      iconSize: [20, 20],\n      iconAnchor: [10, 10]\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"dispersion-map\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"map-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Chemical Dispersion Map\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"map-controls\",\n        children: [selectedSpill && /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleManualCalculation,\n          disabled: isCalculating,\n          className: \"btn btn-primary\",\n          children: isCalculating ? 'Calculating...' : 'Recalculate Dispersion'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"map-legend\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"legend-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"legend-color active\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Active\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 109,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"legend-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"legend-color contained\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 112,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Contained\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"legend-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"legend-color cleaned\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Cleaned\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-message\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setError(null),\n        className: \"btn btn-sm\",\n        children: \"Dismiss\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 17\n    }, this), isCalculating && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"calculation-status\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading-spinner\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Calculating dispersion model for \", selectedSpill === null || selectedSpill === void 0 ? void 0 : selectedSpill.name, \"...\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"map-container\",\n      children: /*#__PURE__*/_jsxDEV(MapContainer, {\n        center: mapCenter,\n        zoom: 10,\n        style: {\n          height: '500px',\n          width: '100%'\n        },\n        children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n          url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n          attribution: \"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 21\n        }, this), spills.map(spill => /*#__PURE__*/_jsxDEV(Marker, {\n          position: [spill.latitude, spill.longitude],\n          icon: createCustomIcon(getMarkerColor(spill)),\n          eventHandlers: {\n            click: () => onSpillSelect(spill)\n          },\n          children: /*#__PURE__*/_jsxDEV(Popup, {\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"spill-popup\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: spill.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 160,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Chemical:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 161,\n                  columnNumber: 40\n                }, this), \" \", spill.chemicalType]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 161,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Volume:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 162,\n                  columnNumber: 40\n                }, this), \" \", spill.volume, \"L\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Status:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 163,\n                  columnNumber: 40\n                }, this), \" \", spill.status]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 163,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Time:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 164,\n                  columnNumber: 40\n                }, this), \" \", new Date(spill.spillTime).toLocaleString()]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 164,\n                columnNumber: 37\n              }, this), spill.id === (selectedSpill === null || selectedSpill === void 0 ? void 0 : selectedSpill.id) && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: handleManualCalculation,\n                disabled: isCalculating,\n                className: \"btn btn-sm btn-primary\",\n                children: \"Calculate Dispersion\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 166,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 159,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 29\n          }, this)\n        }, spill.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 25\n        }, this)), selectedSpill && dispersionData && /*#__PURE__*/_jsxDEV(Circle, {\n          center: [selectedSpill.latitude, selectedSpill.longitude],\n          radius: 1000 // 1km radius for visualization\n          ,\n          pathOptions: {\n            color: 'red',\n            fillColor: 'red',\n            fillOpacity: 0.2\n          },\n          children: /*#__PURE__*/_jsxDEV(Popup, {\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"dispersion-popup\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"Dispersion Zone\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 192,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Affected Area:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 193,\n                  columnNumber: 40\n                }, this), \" \", dispersionData.affectedAreaKm2 || 'N/A', \" km\\xB2\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 193,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Calculation Time:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 194,\n                  columnNumber: 40\n                }, this), \" \", dispersionData.calculationTime]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 194,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 13\n    }, this), selectedSpill && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"spill-details-panel\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Selected Spill Details\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"spill-info-grid\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"info-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Name:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: selectedSpill.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"info-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Chemical:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: selectedSpill.chemicalType\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"info-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Volume:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [selectedSpill.volume, \"L\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"info-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Status:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: `status ${selectedSpill.status.toLowerCase()}`,\n            children: selectedSpill.status\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"info-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Location:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [selectedSpill.latitude.toFixed(4), \", \", selectedSpill.longitude.toFixed(4)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"info-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Reported:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: new Date(selectedSpill.spillTime).toLocaleString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 21\n      }, this), dispersionData && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"dispersion-results\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Dispersion Results\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"results-grid\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"result-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Calculation Time:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 240,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: dispersionData.calculationTime\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 241,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 239,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"result-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Affected Area:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [dispersionData.affectedAreaKm2 || 0, \" km\\xB2\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"result-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Grid Size:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 248,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [((_dispersionData$dispe = dispersionData.dispersionGrid) === null || _dispersionData$dispe === void 0 ? void 0 : _dispersionData$dispe.gridSize) || 100, \"x\", ((_dispersionData$dispe2 = dispersionData.dispersionGrid) === null || _dispersionData$dispe2 === void 0 ? void 0 : _dispersionData$dispe2.gridSize) || 100]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 25\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 92,\n    columnNumber: 9\n  }, this);\n}\n_s(DispersionMap, \"k3d02maRUTuWzYKvNA34ImiBSXw=\");\n_c = DispersionMap;\nexport default DispersionMap;\nvar _c;\n$RefreshReg$(_c, \"DispersionMap\");","map":{"version":3,"names":["React","useState","useEffect","useRef","MapContainer","TileLayer","Marker","Popup","Circle","apiService","L","jsxDEV","_jsxDEV","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","require","iconUrl","shadowUrl","DispersionMap","spills","selectedSpill","onSpillSelect","calculateDispersion","_s","_dispersionData$dispe","_dispersionData$dispe2","dispersionData","setDispersionData","isCalculating","setIsCalculating","error","setError","mapCenter","calculationRef","hasCalculatedRef","Set","lastCalculationRef","id","current","has","handleCalculateDispersion","spillId","console","log","result","add","delete","handleManualCalculation","getMarkerColor","spill","status","createCustomIcon","color","divIcon","className","html","iconSize","iconAnchor","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","name","center","zoom","style","height","width","url","attribution","map","position","latitude","longitude","icon","eventHandlers","click","chemicalType","volume","Date","spillTime","toLocaleString","radius","pathOptions","fillColor","fillOpacity","affectedAreaKm2","calculationTime","toLowerCase","toFixed","dispersionGrid","gridSize","_c","$RefreshReg$"],"sources":["C:/water/chemical-dispersion-app/frontend/src/components/Map/DispersionMap.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup, Circle } from 'react-leaflet';\nimport { apiService } from '../../services/api';\nimport 'leaflet/dist/leaflet.css';\nimport L from 'leaflet';\nimport './DispersionMap.css';\n\n// Fix for default markers in react-leaflet\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n    iconRetinaUrl: require('leaflet/dist/images/marker-icon-2x.png'),\n    iconUrl: require('leaflet/dist/images/marker-icon.png'),\n    shadowUrl: require('leaflet/dist/images/marker-shadow.png'),\n});\n\nfunction DispersionMap({ spills = [], selectedSpill, onSpillSelect, calculateDispersion }) {\n    const [dispersionData, setDispersionData] = useState(null);\n    const [isCalculating, setIsCalculating] = useState(false);\n    const [error, setError] = useState(null);\n    const [mapCenter] = useState([29.7604, -95.3698]); // Houston, TX\n    const calculationRef = useRef(null);\n    const hasCalculatedRef = useRef(new Set()); // Track calculated spills\n    const lastCalculationRef = useRef(null);\n\n    useEffect(() => {\n        // Only calculate if we have a selected spill and haven't calculated it recently\n        if (selectedSpill?.id && \n            !hasCalculatedRef.current.has(selectedSpill.id) && \n            !isCalculating &&\n            lastCalculationRef.current !== selectedSpill.id) {\n            \n            handleCalculateDispersion(selectedSpill.id);\n        }\n    }, [selectedSpill?.id]); // Only depend on spill ID\n\n    const handleCalculateDispersion = async (spillId) => {\n        // Prevent multiple calculations for the same spill\n        if (isCalculating || \n            hasCalculatedRef.current.has(spillId) || \n            lastCalculationRef.current === spillId) {\n            console.log(`[SKIP] Already calculating or calculated for spill ${spillId}`);\n            return;\n        }\n\n        setIsCalculating(true);\n        setError(null);\n        lastCalculationRef.current = spillId;\n        \n        try {\n            console.log(`[CALCULATING] Starting dispersion for spill ${spillId}`);\n            \n            const result = await calculateDispersion(spillId, 24);\n            setDispersionData(result);\n            hasCalculatedRef.current.add(spillId); // Mark as calculated\n            \n            console.log(`[SUCCESS] Dispersion calculation completed for ${spillId}`);\n        } catch (error) {\n            console.error('Dispersion calculation failed:', error);\n            setError('Failed to calculate dispersion. Please try again.');\n            hasCalculatedRef.current.delete(spillId); // Allow retry\n        } finally {\n            setIsCalculating(false);\n        }\n    };\n\n    const handleManualCalculation = () => {\n        if (selectedSpill?.id) {\n            // Force recalculation by removing from calculated set\n            hasCalculatedRef.current.delete(selectedSpill.id);\n            lastCalculationRef.current = null;\n            handleCalculateDispersion(selectedSpill.id);\n        }\n    };\n\n    const getMarkerColor = (spill) => {\n        if (spill.status === 'ACTIVE') return 'red';\n        if (spill.status === 'CONTAINED') return 'orange';\n        if (spill.status === 'CLEANED_UP') return 'green';\n        return 'gray';\n    };\n\n    const createCustomIcon = (color) => {\n        return L.divIcon({\n            className: 'custom-div-icon',\n            html: `<div style=\"background-color: ${color}; width: 20px; height: 20px; border-radius: 50%; border: 2px solid white;\"></div>`,\n            iconSize: [20, 20],\n            iconAnchor: [10, 10]\n        });\n    };\n\n    return (\n        <div className=\"dispersion-map\">\n            <div className=\"map-header\">\n                <h2>Chemical Dispersion Map</h2>\n                <div className=\"map-controls\">\n                    {selectedSpill && (\n                        <button \n                            onClick={handleManualCalculation}\n                            disabled={isCalculating}\n                            className=\"btn btn-primary\"\n                        >\n                            {isCalculating ? 'Calculating...' : 'Recalculate Dispersion'}\n                        </button>\n                    )}\n                    \n                    <div className=\"map-legend\">\n                        <div className=\"legend-item\">\n                            <span className=\"legend-color active\"></span>\n                            <span>Active</span>\n                        </div>\n                        <div className=\"legend-item\">\n                            <span className=\"legend-color contained\"></span>\n                            <span>Contained</span>\n                        </div>\n                        <div className=\"legend-item\">\n                            <span className=\"legend-color cleaned\"></span>\n                            <span>Cleaned</span>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            {error && (\n                <div className=\"error-message\">\n                    <p>{error}</p>\n                    <button onClick={() => setError(null)} className=\"btn btn-sm\">Dismiss</button>\n                </div>\n            )}\n\n            {isCalculating && (\n                <div className=\"calculation-status\">\n                    <div className=\"loading-spinner\"></div>\n                    <p>Calculating dispersion model for {selectedSpill?.name}...</p>\n                </div>\n            )}\n\n            <div className=\"map-container\">\n                <MapContainer \n                    center={mapCenter} \n                    zoom={10} \n                    style={{ height: '500px', width: '100%' }}\n                >\n                    <TileLayer\n                        url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n                        attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n                    />\n                    \n                    {/* Render spill markers */}\n                    {spills.map((spill) => (\n                        <Marker\n                            key={spill.id}\n                            position={[spill.latitude, spill.longitude]}\n                            icon={createCustomIcon(getMarkerColor(spill))}\n                            eventHandlers={{\n                                click: () => onSpillSelect(spill)\n                            }}\n                        >\n                            <Popup>\n                                <div className=\"spill-popup\">\n                                    <h4>{spill.name}</h4>\n                                    <p><strong>Chemical:</strong> {spill.chemicalType}</p>\n                                    <p><strong>Volume:</strong> {spill.volume}L</p>\n                                    <p><strong>Status:</strong> {spill.status}</p>\n                                    <p><strong>Time:</strong> {new Date(spill.spillTime).toLocaleString()}</p>\n                                    {spill.id === selectedSpill?.id && (\n                                        <button \n                                            onClick={handleManualCalculation}\n                                            disabled={isCalculating}\n                                            className=\"btn btn-sm btn-primary\"\n                                        >\n                                            Calculate Dispersion\n                                        </button>\n                                    )}\n                                </div>\n                            </Popup>\n                        </Marker>\n                    ))}\n                    \n                    {/* Render dispersion circle if available */}\n                    {selectedSpill && dispersionData && (\n                        <Circle\n                            center={[selectedSpill.latitude, selectedSpill.longitude]}\n                            radius={1000} // 1km radius for visualization\n                            pathOptions={{\n                                color: 'red',\n                                fillColor: 'red',\n                                fillOpacity: 0.2\n                            }}\n                        >\n                            <Popup>\n                                <div className=\"dispersion-popup\">\n                                    <h4>Dispersion Zone</h4>\n                                    <p><strong>Affected Area:</strong> {dispersionData.affectedAreaKm2 || 'N/A'} km²</p>\n                                    <p><strong>Calculation Time:</strong> {dispersionData.calculationTime}</p>\n                                </div>\n                            </Popup>\n                        </Circle>\n                    )}\n                </MapContainer>\n            </div>\n\n            {/* Spill Details Panel */}\n            {selectedSpill && (\n                <div className=\"spill-details-panel\">\n                    <h3>Selected Spill Details</h3>\n                    <div className=\"spill-info-grid\">\n                        <div className=\"info-item\">\n                            <label>Name:</label>\n                            <span>{selectedSpill.name}</span>\n                        </div>\n                        <div className=\"info-item\">\n                            <label>Chemical:</label>\n                            <span>{selectedSpill.chemicalType}</span>\n                        </div>\n                        <div className=\"info-item\">\n                            <label>Volume:</label>\n                            <span>{selectedSpill.volume}L</span>\n                        </div>\n                        <div className=\"info-item\">\n                            <label>Status:</label>\n                            <span className={`status ${selectedSpill.status.toLowerCase()}`}>\n                                {selectedSpill.status}\n                            </span>\n                        </div>\n                        <div className=\"info-item\">\n                            <label>Location:</label>\n                            <span>{selectedSpill.latitude.toFixed(4)}, {selectedSpill.longitude.toFixed(4)}</span>\n                        </div>\n                        <div className=\"info-item\">\n                            <label>Reported:</label>\n                            <span>{new Date(selectedSpill.spillTime).toLocaleString()}</span>\n                        </div>\n                    </div>\n                    \n                    {dispersionData && (\n                        <div className=\"dispersion-results\">\n                            <h4>Dispersion Results</h4>\n                            <div className=\"results-grid\">\n                                <div className=\"result-item\">\n                                    <label>Calculation Time:</label>\n                                    <span>{dispersionData.calculationTime}</span>\n                                </div>\n                                <div className=\"result-item\">\n                                    <label>Affected Area:</label>\n                                    <span>{dispersionData.affectedAreaKm2 || 0} km²</span>\n                                </div>\n                                <div className=\"result-item\">\n                                    <label>Grid Size:</label>\n                                    <span>{dispersionData.dispersionGrid?.gridSize || 100}x{dispersionData.dispersionGrid?.gridSize || 100}</span>\n                                </div>\n                            </div>\n                        </div>\n                    )}\n                </div>\n            )}\n        </div>\n    );\n}\n\nexport default DispersionMap;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAC1D,SAASC,YAAY,EAAEC,SAAS,EAAEC,MAAM,EAAEC,KAAK,EAAEC,MAAM,QAAQ,eAAe;AAC9E,SAASC,UAAU,QAAQ,oBAAoB;AAC/C,OAAO,0BAA0B;AACjC,OAAOC,CAAC,MAAM,SAAS;AACvB,OAAO,qBAAqB;;AAE5B;AAAA,SAAAC,MAAA,IAAAC,OAAA;AACA,OAAOF,CAAC,CAACG,IAAI,CAACC,OAAO,CAACC,SAAS,CAACC,WAAW;AAC3CN,CAAC,CAACG,IAAI,CAACC,OAAO,CAACG,YAAY,CAAC;EACxBC,aAAa,EAAEC,OAAO,CAAC,wCAAwC,CAAC;EAChEC,OAAO,EAAED,OAAO,CAAC,qCAAqC,CAAC;EACvDE,SAAS,EAAEF,OAAO,CAAC,uCAAuC;AAC9D,CAAC,CAAC;AAEF,SAASG,aAAaA,CAAC;EAAEC,MAAM,GAAG,EAAE;EAAEC,aAAa;EAAEC,aAAa;EAAEC;AAAoB,CAAC,EAAE;EAAAC,EAAA;EAAA,IAAAC,qBAAA,EAAAC,sBAAA;EACvF,MAAM,CAACC,cAAc,EAAEC,iBAAiB,CAAC,GAAG9B,QAAQ,CAAC,IAAI,CAAC;EAC1D,MAAM,CAAC+B,aAAa,EAAEC,gBAAgB,CAAC,GAAGhC,QAAQ,CAAC,KAAK,CAAC;EACzD,MAAM,CAACiC,KAAK,EAAEC,QAAQ,CAAC,GAAGlC,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM,CAACmC,SAAS,CAAC,GAAGnC,QAAQ,CAAC,CAAC,OAAO,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;EACnD,MAAMoC,cAAc,GAAGlC,MAAM,CAAC,IAAI,CAAC;EACnC,MAAMmC,gBAAgB,GAAGnC,MAAM,CAAC,IAAIoC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;EAC5C,MAAMC,kBAAkB,GAAGrC,MAAM,CAAC,IAAI,CAAC;EAEvCD,SAAS,CAAC,MAAM;IACZ;IACA,IAAIsB,aAAa,aAAbA,aAAa,eAAbA,aAAa,CAAEiB,EAAE,IACjB,CAACH,gBAAgB,CAACI,OAAO,CAACC,GAAG,CAACnB,aAAa,CAACiB,EAAE,CAAC,IAC/C,CAACT,aAAa,IACdQ,kBAAkB,CAACE,OAAO,KAAKlB,aAAa,CAACiB,EAAE,EAAE;MAEjDG,yBAAyB,CAACpB,aAAa,CAACiB,EAAE,CAAC;IAC/C;EACJ,CAAC,EAAE,CAACjB,aAAa,aAAbA,aAAa,uBAAbA,aAAa,CAAEiB,EAAE,CAAC,CAAC,CAAC,CAAC;;EAEzB,MAAMG,yBAAyB,GAAG,MAAOC,OAAO,IAAK;IACjD;IACA,IAAIb,aAAa,IACbM,gBAAgB,CAACI,OAAO,CAACC,GAAG,CAACE,OAAO,CAAC,IACrCL,kBAAkB,CAACE,OAAO,KAAKG,OAAO,EAAE;MACxCC,OAAO,CAACC,GAAG,CAAC,sDAAsDF,OAAO,EAAE,CAAC;MAC5E;IACJ;IAEAZ,gBAAgB,CAAC,IAAI,CAAC;IACtBE,QAAQ,CAAC,IAAI,CAAC;IACdK,kBAAkB,CAACE,OAAO,GAAGG,OAAO;IAEpC,IAAI;MACAC,OAAO,CAACC,GAAG,CAAC,+CAA+CF,OAAO,EAAE,CAAC;MAErE,MAAMG,MAAM,GAAG,MAAMtB,mBAAmB,CAACmB,OAAO,EAAE,EAAE,CAAC;MACrDd,iBAAiB,CAACiB,MAAM,CAAC;MACzBV,gBAAgB,CAACI,OAAO,CAACO,GAAG,CAACJ,OAAO,CAAC,CAAC,CAAC;;MAEvCC,OAAO,CAACC,GAAG,CAAC,kDAAkDF,OAAO,EAAE,CAAC;IAC5E,CAAC,CAAC,OAAOX,KAAK,EAAE;MACZY,OAAO,CAACZ,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;MACtDC,QAAQ,CAAC,mDAAmD,CAAC;MAC7DG,gBAAgB,CAACI,OAAO,CAACQ,MAAM,CAACL,OAAO,CAAC,CAAC,CAAC;IAC9C,CAAC,SAAS;MACNZ,gBAAgB,CAAC,KAAK,CAAC;IAC3B;EACJ,CAAC;EAED,MAAMkB,uBAAuB,GAAGA,CAAA,KAAM;IAClC,IAAI3B,aAAa,aAAbA,aAAa,eAAbA,aAAa,CAAEiB,EAAE,EAAE;MACnB;MACAH,gBAAgB,CAACI,OAAO,CAACQ,MAAM,CAAC1B,aAAa,CAACiB,EAAE,CAAC;MACjDD,kBAAkB,CAACE,OAAO,GAAG,IAAI;MACjCE,yBAAyB,CAACpB,aAAa,CAACiB,EAAE,CAAC;IAC/C;EACJ,CAAC;EAED,MAAMW,cAAc,GAAIC,KAAK,IAAK;IAC9B,IAAIA,KAAK,CAACC,MAAM,KAAK,QAAQ,EAAE,OAAO,KAAK;IAC3C,IAAID,KAAK,CAACC,MAAM,KAAK,WAAW,EAAE,OAAO,QAAQ;IACjD,IAAID,KAAK,CAACC,MAAM,KAAK,YAAY,EAAE,OAAO,OAAO;IACjD,OAAO,MAAM;EACjB,CAAC;EAED,MAAMC,gBAAgB,GAAIC,KAAK,IAAK;IAChC,OAAO9C,CAAC,CAAC+C,OAAO,CAAC;MACbC,SAAS,EAAE,iBAAiB;MAC5BC,IAAI,EAAE,iCAAiCH,KAAK,mFAAmF;MAC/HI,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;MAClBC,UAAU,EAAE,CAAC,EAAE,EAAE,EAAE;IACvB,CAAC,CAAC;EACN,CAAC;EAED,oBACIjD,OAAA;IAAK8C,SAAS,EAAC,gBAAgB;IAAAI,QAAA,gBAC3BlD,OAAA;MAAK8C,SAAS,EAAC,YAAY;MAAAI,QAAA,gBACvBlD,OAAA;QAAAkD,QAAA,EAAI;MAAuB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAChCtD,OAAA;QAAK8C,SAAS,EAAC,cAAc;QAAAI,QAAA,GACxBtC,aAAa,iBACVZ,OAAA;UACIuD,OAAO,EAAEhB,uBAAwB;UACjCiB,QAAQ,EAAEpC,aAAc;UACxB0B,SAAS,EAAC,iBAAiB;UAAAI,QAAA,EAE1B9B,aAAa,GAAG,gBAAgB,GAAG;QAAwB;UAAA+B,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxD,CACX,eAEDtD,OAAA;UAAK8C,SAAS,EAAC,YAAY;UAAAI,QAAA,gBACvBlD,OAAA;YAAK8C,SAAS,EAAC,aAAa;YAAAI,QAAA,gBACxBlD,OAAA;cAAM8C,SAAS,EAAC;YAAqB;cAAAK,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eAC7CtD,OAAA;cAAAkD,QAAA,EAAM;YAAM;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAClB,CAAC,eACNtD,OAAA;YAAK8C,SAAS,EAAC,aAAa;YAAAI,QAAA,gBACxBlD,OAAA;cAAM8C,SAAS,EAAC;YAAwB;cAAAK,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eAChDtD,OAAA;cAAAkD,QAAA,EAAM;YAAS;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACrB,CAAC,eACNtD,OAAA;YAAK8C,SAAS,EAAC,aAAa;YAAAI,QAAA,gBACxBlD,OAAA;cAAM8C,SAAS,EAAC;YAAsB;cAAAK,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eAC9CtD,OAAA;cAAAkD,QAAA,EAAM;YAAO;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACnB,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACL,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CAAC,EAELhC,KAAK,iBACFtB,OAAA;MAAK8C,SAAS,EAAC,eAAe;MAAAI,QAAA,gBAC1BlD,OAAA;QAAAkD,QAAA,EAAI5B;MAAK;QAAA6B,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACdtD,OAAA;QAAQuD,OAAO,EAAEA,CAAA,KAAMhC,QAAQ,CAAC,IAAI,CAAE;QAACuB,SAAS,EAAC,YAAY;QAAAI,QAAA,EAAC;MAAO;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAC7E,CACR,EAEAlC,aAAa,iBACVpB,OAAA;MAAK8C,SAAS,EAAC,oBAAoB;MAAAI,QAAA,gBAC/BlD,OAAA;QAAK8C,SAAS,EAAC;MAAiB;QAAAK,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC,eACvCtD,OAAA;QAAAkD,QAAA,GAAG,mCAAiC,EAACtC,aAAa,aAAbA,aAAa,uBAAbA,aAAa,CAAE6C,IAAI,EAAC,KAAG;MAAA;QAAAN,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAC/D,CACR,eAEDtD,OAAA;MAAK8C,SAAS,EAAC,eAAe;MAAAI,QAAA,eAC1BlD,OAAA,CAACR,YAAY;QACTkE,MAAM,EAAElC,SAAU;QAClBmC,IAAI,EAAE,EAAG;QACTC,KAAK,EAAE;UAAEC,MAAM,EAAE,OAAO;UAAEC,KAAK,EAAE;QAAO,CAAE;QAAAZ,QAAA,gBAE1ClD,OAAA,CAACP,SAAS;UACNsE,GAAG,EAAC,oDAAoD;UACxDC,WAAW,EAAC;QAAyF;UAAAb,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxG,CAAC,EAGD3C,MAAM,CAACsD,GAAG,CAAExB,KAAK,iBACdzC,OAAA,CAACN,MAAM;UAEHwE,QAAQ,EAAE,CAACzB,KAAK,CAAC0B,QAAQ,EAAE1B,KAAK,CAAC2B,SAAS,CAAE;UAC5CC,IAAI,EAAE1B,gBAAgB,CAACH,cAAc,CAACC,KAAK,CAAC,CAAE;UAC9C6B,aAAa,EAAE;YACXC,KAAK,EAAEA,CAAA,KAAM1D,aAAa,CAAC4B,KAAK;UACpC,CAAE;UAAAS,QAAA,eAEFlD,OAAA,CAACL,KAAK;YAAAuD,QAAA,eACFlD,OAAA;cAAK8C,SAAS,EAAC,aAAa;cAAAI,QAAA,gBACxBlD,OAAA;gBAAAkD,QAAA,EAAKT,KAAK,CAACgB;cAAI;gBAAAN,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CAAC,eACrBtD,OAAA;gBAAAkD,QAAA,gBAAGlD,OAAA;kBAAAkD,QAAA,EAAQ;gBAAS;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ,CAAC,KAAC,EAACb,KAAK,CAAC+B,YAAY;cAAA;gBAAArB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eACtDtD,OAAA;gBAAAkD,QAAA,gBAAGlD,OAAA;kBAAAkD,QAAA,EAAQ;gBAAO;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ,CAAC,KAAC,EAACb,KAAK,CAACgC,MAAM,EAAC,GAAC;cAAA;gBAAAtB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAG,CAAC,eAC/CtD,OAAA;gBAAAkD,QAAA,gBAAGlD,OAAA;kBAAAkD,QAAA,EAAQ;gBAAO;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ,CAAC,KAAC,EAACb,KAAK,CAACC,MAAM;cAAA;gBAAAS,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eAC9CtD,OAAA;gBAAAkD,QAAA,gBAAGlD,OAAA;kBAAAkD,QAAA,EAAQ;gBAAK;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ,CAAC,KAAC,EAAC,IAAIoB,IAAI,CAACjC,KAAK,CAACkC,SAAS,CAAC,CAACC,cAAc,CAAC,CAAC;cAAA;gBAAAzB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,EACzEb,KAAK,CAACZ,EAAE,MAAKjB,aAAa,aAAbA,aAAa,uBAAbA,aAAa,CAAEiB,EAAE,kBAC3B7B,OAAA;gBACIuD,OAAO,EAAEhB,uBAAwB;gBACjCiB,QAAQ,EAAEpC,aAAc;gBACxB0B,SAAS,EAAC,wBAAwB;gBAAAI,QAAA,EACrC;cAED;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CACX;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACA;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH;QAAC,GAxBHb,KAAK,CAACZ,EAAE;UAAAsB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAyBT,CACX,CAAC,EAGD1C,aAAa,IAAIM,cAAc,iBAC5BlB,OAAA,CAACJ,MAAM;UACH8D,MAAM,EAAE,CAAC9C,aAAa,CAACuD,QAAQ,EAAEvD,aAAa,CAACwD,SAAS,CAAE;UAC1DS,MAAM,EAAE,IAAK,CAAC;UAAA;UACdC,WAAW,EAAE;YACTlC,KAAK,EAAE,KAAK;YACZmC,SAAS,EAAE,KAAK;YAChBC,WAAW,EAAE;UACjB,CAAE;UAAA9B,QAAA,eAEFlD,OAAA,CAACL,KAAK;YAAAuD,QAAA,eACFlD,OAAA;cAAK8C,SAAS,EAAC,kBAAkB;cAAAI,QAAA,gBAC7BlD,OAAA;gBAAAkD,QAAA,EAAI;cAAe;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eACxBtD,OAAA;gBAAAkD,QAAA,gBAAGlD,OAAA;kBAAAkD,QAAA,EAAQ;gBAAc;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ,CAAC,KAAC,EAACpC,cAAc,CAAC+D,eAAe,IAAI,KAAK,EAAC,SAAI;cAAA;gBAAA9B,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAG,CAAC,eACpFtD,OAAA;gBAAAkD,QAAA,gBAAGlD,OAAA;kBAAAkD,QAAA,EAAQ;gBAAiB;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ,CAAC,KAAC,EAACpC,cAAc,CAACgE,eAAe;cAAA;gBAAA/B,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACzE;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACJ,CACX;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACS;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACd,CAAC,EAGL1C,aAAa,iBACVZ,OAAA;MAAK8C,SAAS,EAAC,qBAAqB;MAAAI,QAAA,gBAChClD,OAAA;QAAAkD,QAAA,EAAI;MAAsB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC/BtD,OAAA;QAAK8C,SAAS,EAAC,iBAAiB;QAAAI,QAAA,gBAC5BlD,OAAA;UAAK8C,SAAS,EAAC,WAAW;UAAAI,QAAA,gBACtBlD,OAAA;YAAAkD,QAAA,EAAO;UAAK;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eACpBtD,OAAA;YAAAkD,QAAA,EAAOtC,aAAa,CAAC6C;UAAI;YAAAN,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAChC,CAAC,eACNtD,OAAA;UAAK8C,SAAS,EAAC,WAAW;UAAAI,QAAA,gBACtBlD,OAAA;YAAAkD,QAAA,EAAO;UAAS;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eACxBtD,OAAA;YAAAkD,QAAA,EAAOtC,aAAa,CAAC4D;UAAY;YAAArB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxC,CAAC,eACNtD,OAAA;UAAK8C,SAAS,EAAC,WAAW;UAAAI,QAAA,gBACtBlD,OAAA;YAAAkD,QAAA,EAAO;UAAO;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eACtBtD,OAAA;YAAAkD,QAAA,GAAOtC,aAAa,CAAC6D,MAAM,EAAC,GAAC;UAAA;YAAAtB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACnC,CAAC,eACNtD,OAAA;UAAK8C,SAAS,EAAC,WAAW;UAAAI,QAAA,gBACtBlD,OAAA;YAAAkD,QAAA,EAAO;UAAO;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eACtBtD,OAAA;YAAM8C,SAAS,EAAE,UAAUlC,aAAa,CAAC8B,MAAM,CAACyC,WAAW,CAAC,CAAC,EAAG;YAAAjC,QAAA,EAC3DtC,aAAa,CAAC8B;UAAM;YAAAS,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACnB,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC,eACNtD,OAAA;UAAK8C,SAAS,EAAC,WAAW;UAAAI,QAAA,gBACtBlD,OAAA;YAAAkD,QAAA,EAAO;UAAS;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eACxBtD,OAAA;YAAAkD,QAAA,GAAOtC,aAAa,CAACuD,QAAQ,CAACiB,OAAO,CAAC,CAAC,CAAC,EAAC,IAAE,EAACxE,aAAa,CAACwD,SAAS,CAACgB,OAAO,CAAC,CAAC,CAAC;UAAA;YAAAjC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACrF,CAAC,eACNtD,OAAA;UAAK8C,SAAS,EAAC,WAAW;UAAAI,QAAA,gBACtBlD,OAAA;YAAAkD,QAAA,EAAO;UAAS;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eACxBtD,OAAA;YAAAkD,QAAA,EAAO,IAAIwB,IAAI,CAAC9D,aAAa,CAAC+D,SAAS,CAAC,CAACC,cAAc,CAAC;UAAC;YAAAzB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAChE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL,CAAC,EAELpC,cAAc,iBACXlB,OAAA;QAAK8C,SAAS,EAAC,oBAAoB;QAAAI,QAAA,gBAC/BlD,OAAA;UAAAkD,QAAA,EAAI;QAAkB;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAC3BtD,OAAA;UAAK8C,SAAS,EAAC,cAAc;UAAAI,QAAA,gBACzBlD,OAAA;YAAK8C,SAAS,EAAC,aAAa;YAAAI,QAAA,gBACxBlD,OAAA;cAAAkD,QAAA,EAAO;YAAiB;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eAChCtD,OAAA;cAAAkD,QAAA,EAAOhC,cAAc,CAACgE;YAAe;cAAA/B,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC5C,CAAC,eACNtD,OAAA;YAAK8C,SAAS,EAAC,aAAa;YAAAI,QAAA,gBACxBlD,OAAA;cAAAkD,QAAA,EAAO;YAAc;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eAC7BtD,OAAA;cAAAkD,QAAA,GAAOhC,cAAc,CAAC+D,eAAe,IAAI,CAAC,EAAC,SAAI;YAAA;cAAA9B,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACrD,CAAC,eACNtD,OAAA;YAAK8C,SAAS,EAAC,aAAa;YAAAI,QAAA,gBACxBlD,OAAA;cAAAkD,QAAA,EAAO;YAAU;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACzBtD,OAAA;cAAAkD,QAAA,GAAO,EAAAlC,qBAAA,GAAAE,cAAc,CAACmE,cAAc,cAAArE,qBAAA,uBAA7BA,qBAAA,CAA+BsE,QAAQ,KAAI,GAAG,EAAC,GAAC,EAAC,EAAArE,sBAAA,GAAAC,cAAc,CAACmE,cAAc,cAAApE,sBAAA,uBAA7BA,sBAAA,CAA+BqE,QAAQ,KAAI,GAAG;YAAA;cAAAnC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC7G,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACL,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL,CACR;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACA,CACR;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACA,CAAC;AAEd;AAACvC,EAAA,CAlPQL,aAAa;AAAA6E,EAAA,GAAb7E,aAAa;AAoPtB,eAAeA,aAAa;AAAC,IAAA6E,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}